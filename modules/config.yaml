version: 1
enabled:
  - homeassistant.observer
  - code.assistant
  - network.discovery
  - face.recognition
  - voice.mic_rtsp
  - insights
  - selfheal
modules:
  homeassistant.observer:
    base_url: "http://192.168.1.140:8123"
    token_env: "PUMPKIN_HA_TOKEN"
    include_domains:
      - "*"
    calendar_enabled: true
    calendar_days_ahead: 7
    calendar_limit: 10
    calendar_shared:
      - calendar.ross_family_calendar
    calendar_people:
      person.paul_ross: calendar.ross_family_calendar
    attribute_allowlist:
      - friendly_name
      - device_class
      - unit_of_measurement
      - icon
      - battery_level
      - temperature
      - current_temperature
      - humidity
      - brightness
      - hvac_mode
      - hvac_action
      - preset_mode
  code.assistant:
    repo_root: "/home/rossp"
    require_approval: true
  network.discovery:
    subnet: "auto"
    tcp_ports:
      - 22
      - 80
      - 81
      - 443
      - 554
      - 8000
      - 8008
      - 8009
      - 8080
      - 8123
      - 8443
      - 8554
      - 8899
      - 9000
      - 9100
      - 9443
      - 1400
      - 37777
      - 62078
    timeout_seconds: 1.0
    fast_ports:
      - 22
      - 80
      - 443
      - 554
      - 8000
      - 8554
      - 8123
    fast_timeout_seconds: 0.2
    max_hosts: 254
    max_scan_seconds: 60
    scan_interval_seconds: 300
    active:
      enabled: true
      scan_subnet: true
      ssdp: true
      http: true
      rtsp: true
      ssh: true
      max_banner_bytes: 256
      max_http_bytes: 2048
      max_ssdp_responses: 32
  face.recognition:
    enabled: true
    scan_interval_seconds: 300
    max_cameras_per_run: 2
    timeout_seconds: 10
    ffmpeg_path: "ffmpeg"
    provider:
      type: "compreface"
      endpoint: "http://127.0.0.1:8000/api/v1/recognition/recognize"
      api_key_env: "PUMPKIN_FACE_API_KEY"
      min_confidence: 0.45
      timeout_seconds: 6
    cameras:
      - id: ring-doorbell
        label: "front door"
        source: "rtsp"
        rtsp_url: "rtsp://192.168.1.157:37153/573b5ae1a0487989"
        enabled: true
      - id: kitchen-cam
        label: "kitchen"
        source: "onvif"
        ip: "192.168.1.127"
        rtsp_port: 8554
        rtsp_url: "rtsp://{user}:{password}@192.168.1.127:8554/Streaming/Channels/102"
        rtsp_paths:
          - /Streaming/Channels/102
          - /Streaming/Channels/101
          - /live
          - /h264
        auth_env:
          user: "PUMPKIN_KITCHEN_CAM_USER"
          pass: "PUMPKIN_KITCHEN_CAM_PASS"
        auto_probe: true
        enabled: true
    behavior:
      enabled: true
      camera_ids:
        - kitchen-cam
      alert_cooldown_minutes: 30
      dog_names:
        - Roary
        - Ozzy
      forbidden_objects:
        - spray bottle
        - spray cleaner
        - bottle
      countertop_watch: true
      visual:
        enabled: true
      bark_audio:
        enabled: true
        seconds: 2
        threshold_db: -20
  voice.mic_rtsp:
    enabled: true
    camera_id: "kitchen-cam"
    capture_seconds: 2.5
    poll_interval_seconds: 10
    cooldown_seconds: 15
    threshold_db: -50
    debug: true
    sample_rate: 16000
    channels: 1
    wake_words:
      - "pumpkin"
      - "hey pumpkin"
    min_chars: 4
    ffmpeg_path: "ffmpeg"
    post_async: true
  car.telemetry:
    baseline:
      mode: "auto"
      window_days: 30
      label: "generic"
      speed_mph_max: 90
      rpm_max: 4000
      coolant_c_max: 105
      idle_pct_max: 0.5
  selfheal:
    enabled: true
    cooldown_seconds: 300
    max_actions_per_run: 1
    restart_voice: true
    reset_ha_cooldown: true
    rescan_network: true
  insights:
    door_open_warn_minutes: 10
    lights_on_warn_minutes: 30
    motion_recent_minutes: 5
    briefing_times:
      - "08:00"
      - "20:00"
    event_briefing_min_minutes: 30
    auto_notify_min_minutes: 30
    auto_notify_types:
      - "insight.new_device"
      - "insight.inventory_change"
      - "insight.face_alert"
      - "insight.camera_issue"
  voice:
    confirmations_enabled: false
    confirm_llm_low_confidence: false
