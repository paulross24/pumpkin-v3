# Canonical editable policy source. Proposals/actions record policy_hash for traceability.
version: 1
mode: strict
defaults:
  require_approval: false
approval:
  max_auto_approve_risk: 1.0
  risky_action_types:
    - network.dns_change
    - network.cloudflared_change
    - network.firewall_change
    - code.apply_patch
auto_approve: []
actions:
  - action_type: notify.local
    params_schema:
      type: object
      properties:
        message:
          type: string
          maxLength: 2000
      required:
        - message
  - action_type: code.apply_patch
    params_schema:
      type: object
      properties:
        repo_root:
          type: string
          maxLength: 500
        patch:
          type: string
          maxLength: 200000
      required:
        - repo_root
        - patch
  - action_type: network.deep_scan
    params_schema:
      type: object
      properties:
        ip:
          type: string
          maxLength: 128
        ports:
          type: array
          items:
            type: integer
      required:
        - ip
  - action_type: network.mark_useful
    params_schema:
      type: object
      properties:
        ip:
          type: string
          maxLength: 128
        label:
          type: string
          maxLength: 80
        note:
          type: string
          maxLength: 200
      required:
        - ip
